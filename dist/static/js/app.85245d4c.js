(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+rOxwC":function(e,t,n){},"/vcn99":function(e,t,n){},"2YZa3H":function(e,t,n){"use strict";n.r(t);n("55Il9k"),n("eQL0Q3"),n("GL+wph"),n("DpIS2g");var r,i,o,a=n("q1tIBJ"),l=n("i8i4Lr"),c=(n("IA2xiS"),n("jh8Gba"),n("HG3Ph5")),u="#1475b2",s="#42c02e",d=function(e){var t=e.title,n=e.content,r=e.backgroundColor,i=["%c ".concat(t," %c ").concat(n," "),"padding: 1px; border-radius: 3px 0 0 3px; color: #fff; background: ".concat("#606060",";"),"padding: 1px; border-radius: 0 3px 3px 0; color: #fff; background: ".concat(r,";")];return function(){var e;window.console&&"function"==typeof window.console.log&&(e=console).log.apply(e,arguments)}.apply(void 0,i),i};l.render(a.createElement(c.a,null),document.getElementById("root")),i=(r={title:"Environment",content:"production"}).title,o=r.content,d({title:i,content:o,backgroundColor:s}),function(e){var t=e.title,n=e.content;d({title:t,content:n,backgroundColor:u})}({title:"Version",content:"v1.0.0"})},HG3Ph5:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return v});var r,i=n("/HRNTg"),o=n.n(i),a=n("WaGiO0"),l=n.n(a),c=n("ZDA2j/"),u=n.n(c),s=n("/+P4SW"),d=n.n(s),f=n("N9n2Pb"),h=n.n(f),p=n("q1tIBJ"),y=n("0cfB3O"),g=n("QXNo0m"),m=n("O0lQ/B");n("NX+1pV");Object(m.a)();var v=Object(y.hot)(e)(r=function(e){function t(){return o()(this,t),u()(this,d()(t).apply(this,arguments))}return h()(t,e),l()(t,[{key:"render",value:function(){return p.createElement("div",{className:"app"},p.createElement("p",null,"rich text editor with draft.js"),p.createElement(g.a,null))}}]),t}(p.PureComponent))||r}).call(this,n("3UD+zm")(e))},KTZtcz:function(e,t,n){},"NX+1pV":function(e,t,n){},"O0lQ/B":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n("7O5WXI"),i=n("wHSuel");function o(){r.b.add(i.a,i.e,i.l,i.k,i.c,i.b,i.j,i.h,i.g,i.f,i.d,i.i,i.m)}},QXNo0m:function(e,t,n){"use strict";n("L/Qfgs");var r=n("2/RpK8"),i=n("htGi8S"),o=n.n(i),a=n("XXOK8D"),l=n.n(a),c=n("/HRNTg"),u=n.n(c),s=n("WaGiO0"),d=n.n(s),f=n("ZDA2j/"),h=n.n(f),p=n("/+P4SW"),y=n.n(p),g=n("N9n2Pb"),m=n.n(g),v=n("q1tIBJ"),E=n("yeYm6u"),C=n.n(E),k=n("v83y9F"),S=n("T40182"),b=n.n(S),K=n("TSYQbt"),T=n.n(K),D=(n("KTZtcz"),"divider"),O="link",B="image",L="image-caption",w="atomic",I=function(e,t){var n=e.getLength(),r=e.getKey(),i=t.getStartKey(),o=t.getEndKey(),a=t.getEndOffset();if(t.getStartKey()!==r)return!1;var l=i!==o,c=n===a&&t.isCollapsed();return l||c},x=function(e){var t=e.getSelection();return e.getCurrentContent().getBlockForKey(t.getStartKey())},R=function(e){var t={inlineDisabled:!1,blockDisabled:!1,linkDisabled:!1,entityDisabled:!1,clearFormatDisabled:!1},n=e.getSelection(),r=k.RichUtils.getCurrentBlockType(e);return r===w&&(t.inlineDisabled=!0,t.blockDisabled=!0,t.linkDisabled=!0,t.entityDisabled=!0,t.clearFormatDisabled=!0),"code-block"===r&&(t.inlineDisabled=!0,t.linkDisabled=!0,t.entityDisabled=!0),n.getAnchorKey()!==n.getFocusKey()&&(t.linkDisabled=!0),t},M=function(e){var t=null,n=e.getCurrentContent(),r=e.getSelection(),i=x(e);if(!i)return t;if(i.getType()!==w&&r.isCollapsed()){var o=r.getFocusOffset(),a=i.getEntityAt(o)||i.getEntityAt(o-1);if(a){var l=n.getEntity(a),c=i.getKey();l.getType()===O&&(t={blockKey:c,entityKey:a,url:l.getData().url})}}return t},A=function(e,t,n){var r=e.getCurrentContent().getBlockForKey(t),i=new k.SelectionState({anchorKey:t,focusKey:t});return r.findEntityRanges(function(e){return e.getEntity()===n},function(e,t){i=i.merge({anchorOffset:e,focusOffset:t})}),i},U=n("xHqaib"),N=n.n(U),P=n("pLtpNf"),F=n.n(P),H=n("AvpfjP"),q=n.n(H),j=n("EY6eGz"),W=n.n(j),z=n("JPcvh7"),G=function(e,t){var n=t.title,r=t.url,i=e.getCurrentContent(),o=e.getSelection(),a=i.createEntity(O,"MUTABLE",{url:r}).getLastCreatedEntityKey(),l=k.Modifier.replaceText(i,o,n,void 0,a);return k.EditorState.push(e,l,"insert-characters")},V=function(e,t){var n=t.title,r=t.url,i=t.blockKey,o=t.entityKey,a=A(e,i,o),l=k.EditorState.forceSelection(e,a),c=l.getSelection(),u=c.getAnchorOffset()+n.length;return k.EditorState.forceSelection(G(l,{title:n,url:r}),c.merge({focusOffset:u,anchorOffset:u}))},X=function(e,t,n){var r=e.getSelection(),i=A(e,t,n);return k.EditorState.forceSelection(k.RichUtils.toggleLink(e,i,null),r)},Z=function(e,t){var n=t.src,r=t.caption,i=W()(t,["src","caption"]),o=e.getCurrentContent().createEntity(B,"IMMUTABLE",q()({src:n,caption:r},i)).getLastCreatedEntityKey(),a=k.AtomicBlockUtils.insertAtomicBlock(e,o," ");return k.EditorState.forceSelection(a,a.getCurrentContent().getSelectionAfter())},J=function(e,t,n){var r=e.getCurrentContent(),i=e.getSelection(),o=r.mergeEntityData(t,n),a=k.EditorState.push(e,o,"apply-entity");return k.EditorState.forceSelection(a,i)},Q=function(e){var t=e.getCurrentContent(),n=e.getSelection(),r=n.getStartKey(),i=k.Modifier.splitBlock(t,n),o=i.getKeyAfter(r),a=k.SelectionState.createEmpty(o),l=k.Modifier.setBlockType(i,a,"unstyled");return k.EditorState.forceSelection(k.EditorState.push(e,l,"split-block"),a)},Y=function(e,t){return F()(k.DefaultDraftInlineStyle).reduce(function(e,n){return k.Modifier.removeInlineStyle(e,t,n)},e)},_=function(e,t){var n=e.getCurrentContent(),r=e.getSelection(),i=r.getStartKey(),o=n.getBlockMap(),a=x(e).merge({text:"",type:t}),l=n.mergeDeep({blockMap:o.set(i,a),selectionAfter:r.merge({anchorOffset:0,focusOffset:0})});return k.EditorState.push(e,l,"change-block-type")},$=function(e){var t=e.getCurrentContent(),n=e.getSelection(),r=function(e,t){var n=e.getBlockMap(),r=t.getStartKey(),i=t.getEndKey(),o=n.toKeyedSeq().skipUntil(function(e,t){return t===r}).takeUntil(function(e,t){return t===i}).concat(z.Map(N()({},i,n.get(i)))).map(function(e){return e.getType()===w?e:e.set("type","unstyled")}),a=n.merge(o);return e.set("blockMap",a)}(Y(t,n),n);return k.EditorState.forceSelection(k.EditorState.push(e,r,"change-block-type"),n)},ee=n("pXlzV6"),te=/<blockquote>([\w\W]*?)<\/blockquote>/g,ne=function(e){return e.replace(te,function(e,t){return t.replace(/<p>/g,"<blockquote>").replace(/<\/p>/g,"</blockquote>")})},re=function(e){return window.navigator&&/Mac/i.test(navigator.userAgent)?e.replace(/\+/g,""):e.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt")},ie=/\n/g,oe=function(e){return e.classList.contains("image-package")},ae=function(e){return e.classList.contains("image-caption")};var le=v.createContext({editorState:k.EditorState.createEmpty(),readOnly:!1}),ce=function(){function e(){u()(this,e),this.all=void 0,this.isStop=void 0,this.all={},this.isStop=!1}return d()(e,[{key:"on",value:function(e,t){this.all[e]||(this.all[e]=[]),this.all[e].includes(t)||this.all[e].push(t)}},{key:"off",value:function(e,t){this.all[e]&&(this.all[e]=this.all[e].filter(function(e){return e!==t}))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.isStop||(this.all[e]||[]).forEach(function(e){e.apply(void 0,n)})}},{key:"destroy",value:function(e){this.all[e]=[]}},{key:"startEmit",value:function(){this.isStop=!1}},{key:"stopEmit",value:function(){this.isStop=!0}},{key:"destroyAll",value:function(){this.all={}}}]),e}(),ue=(n("TfFZP2"),n("3S7+Bm")),se=n("lSCDUm"),de=n.n(se),fe=n("IP2giS"),he="editor-control-btn",pe=function(e){function t(){var e,n;u()(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=h()(this,(e=y()(t)).call.apply(e,[this].concat(i)))).handleClick=function(){var e=n.props,t=e.disabled,r=e.command,i=e.onCommand;t||de()(i)&&i(r)},n.getButton=function(){var e,t=n.props,r=t.label,i=t.icon,o=t.active,a=t.disabled,l=t.className,c=T()((e={},N()(e,"".concat(l),!!l),N()(e,he,!0),N()(e,"".concat(he,"-active"),o),N()(e,"".concat(he,"-disabled"),a),e));return v.createElement("span",{role:"button",tabIndex:0,"aria-pressed":o,"aria-disabled":a,className:c,onClick:n.handleClick},i?v.createElement(fe.a,{icon:i}):r)},n}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.shortcut,n=e.text,r=e.disabled;if(t&&!r){var i="".concat(n,"(").concat(re(t),")");return v.createElement(ue.a,{title:i},this.getButton())}return this.getButton()}}]),t}(v.PureComponent),ye=function(e){function t(){return u()(this,t),h()(this,y()(t).apply(this,arguments))}return m()(t,e),d()(t,[{key:"render",value:function(){return v.createElement("span",{className:"editor-control-toolbar-separator"})}}]),t}(v.PureComponent),ge=[{text:"粗体",styleType:"BOLD",icon:"bold",shortcut:"⌘+B"},{text:"斜体",styleType:"ITALIC",icon:"italic",shortcut:"⌘+I"},{text:"下划线",styleType:"UNDERLINE",icon:"underline",shortcut:"⌘+U"},{text:"删除线",styleType:"STRIKETHROUGH",icon:"strikethrough",shortcut:"⌘+D"},{text:"Code",styleType:"CODE",icon:"highlighter",shortcut:"⌘+J"}],me=[{text:"一级标题",label:"H1",styleType:"header-one",shortcut:"⌘+⌥+1"},{text:"二级标题",label:"H2",styleType:"header-two",shortcut:"⌘+⌥+2"},{text:"三级标题",label:"H3",styleType:"header-three",shortcut:"⌘+⌥+3"},{text:"四级标题",label:"H4",styleType:"header-four",shortcut:"⌘+⌥+4"},{text:"代码块",styleType:"code-block",icon:"code",shortcut:"⌘+⇧+J"},{text:"引用块",styleType:"blockquote",icon:"quote-left",shortcut:"⌘+⇧+B"},{text:"无序列表",styleType:"unordered-list-item",icon:"list-ul",shortcut:"⌘+⇧+U"},{text:"有序列表",styleType:"ordered-list-item",icon:"list-ol",shortcut:"⌘+⇧+O"}],ve=(n("ps4ltS"),function(e){function t(){var e,n;u()(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=h()(this,(e=y()(t)).call.apply(e,[this].concat(i)))).preventDefault=function(e){e.preventDefault()},n}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.editorState,n=e.onCommand,r=R(t),i=r.inlineDisabled,o=r.blockDisabled,a=r.linkDisabled,l=r.entityDisabled,c=r.clearFormatDisabled,u=t.getCurrentInlineStyle(),s=k.RichUtils.getCurrentBlockType(t);return v.createElement("div",{role:"toolbar",tabIndex:0,className:"editor-control-toolbar",onMouseDown:this.preventDefault},ge.map(function(e){return v.createElement(pe,{key:e.styleType,active:u.has(e.styleType),label:e.label,icon:e.icon,disabled:i,shortcut:e.shortcut,text:e.text,command:"toggle-inline-style-".concat(e.styleType),onCommand:n})}),v.createElement(ye,null),me.map(function(e){return v.createElement(pe,{key:e.styleType,label:e.label,active:s===e.styleType,icon:e.icon,disabled:o,shortcut:e.shortcut,text:e.text,command:"toggle-block-type-".concat(e.styleType),onCommand:n})}),v.createElement(ye,null),v.createElement(pe,{icon:"link",active:!1,disabled:a,shortcut:"⌘+K",text:"插入链接",command:"insert-link",onCommand:n}),v.createElement(pe,{icon:"image",active:!1,disabled:l,shortcut:"⌘+⇧+I",text:"上传图片",command:"insert-image",onCommand:n}),v.createElement(pe,{icon:"minus",active:!1,disabled:l,shortcut:"⌘+⇧+D",text:"插入分割线",command:"insert-divider",onCommand:n}),v.createElement(ye,null),v.createElement(pe,{icon:"wrench",active:!1,disabled:c,shortcut:"⌘+⇧+L",text:"清除所有格式",command:"clear-format",onCommand:n}))}}]),t}(v.PureComponent)),Ee=(n("k3GpqU"),n("kLXVTw")),Ce=(n("1vPlYR"),n("5rEg65")),ke=(n("2oDEb8"),n("CtXQIS")),Se="^((https?):\\/\\/)?([-_A-Za-z0-9]+(\\.))+[-_A-Za-z0-9]{2,}([-_/A-Za-z0-9]+)*",be=new RegExp("".concat(Se,"$")),Ke=new RegExp(Se),Te=/^(\?[-_A-Za-z0-9&@#\/%?=~|!:.,;\u4e00-\u9fa5]*)*$/;function De(e){if(be.test(e))return!0;var t=e.replace(Ke,"");return Ke.test(e)&&Te.test(t)}new RegExp("^(?:(?:http|https|ftp)://|//)?(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i");var Oe=function(e){function t(e){var n;return u()(this,t),(n=h()(this,y()(t).call(this,e))).handleLinkInputMount=function(e){if(e){var t=n.props,r=t.defaultTitle,i=t.defaultUrl;n.setState({title:r,url:i},function(){e.input.select()})}},n.handleOk=function(e){var t=n.state,r=t.title,i=t.url;De(i)&&n.props.onOk(e,{title:r||i,url:/^https?:\/\//.test(i)?i:"http://".concat(i)})},n.handleCancel=function(e){n.props.onCancel(e,!0)},n.clear=function(){n.setState({title:"",url:""})},n.handleTitleChange=function(e){n.setState({title:e.target.value})},n.handleUrlChange=function(e){n.setState({url:e.target.value})},n.state={title:"",url:""},n}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props.visible,t=this.state,n=t.title,r=t.url,i=De(r);return v.createElement(Ee.a,{title:"插入链接",width:400,visible:e,onOk:this.handleOk,onCancel:this.handleCancel,afterClose:this.clear,okButtonProps:{disabled:!i},centered:!0,destroyOnClose:!0},v.createElement(Ce.a,{placeholder:"请输入链接文本",value:n,onChange:this.handleTitleChange,style:{marginBottom:12},prefix:v.createElement(ke.a,{type:"edit"}),onPressEnter:this.handleOk}),v.createElement(Ce.a,{placeholder:"请输入链接地址",value:r,onChange:this.handleUrlChange,prefix:v.createElement(ke.a,{type:"link"}),onPressEnter:this.handleOk,ref:this.handleLinkInputMount}))}}]),t}(v.PureComponent);Oe.defaultProps={defaultTitle:"",defaultUrl:""};var Be,Le,we,Ie,xe,Re,Me=function(e){return e.displayName||e.name||"Component"},Ae=n("i8i4Lr"),Ue=function(e){function t(e){var n;return u()(this,t),(n=h()(this,y()(t).call(this,e))).container=void 0,n.container=null,n}return m()(t,e),d()(t,[{key:"componentDidMount",value:function(){this.createContainer()}},{key:"componentWillUnmount",value:function(){this.removeContainer()}},{key:"createContainer",value:function(){this.container=this.props.getContainer(),this.forceUpdate()}},{key:"removeContainer",value:function(){this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}},{key:"render",value:function(){return this.container?Object(Ae.createPortal)(this.props.children,this.container):null}}]),t}(v.PureComponent),Ne=function(e){return function(t){var n,r;return r=n=function(n){function r(){return u()(this,r),h()(this,y()(r).apply(this,arguments))}return m()(r,n),d()(r,[{key:"render",value:function(){return v.createElement(Ue,{getContainer:e},v.createElement(t,this.props))}}]),r}(v.PureComponent),n.displayName="withPortal(".concat(Me(t),")"),r}},Pe=(n("v9FTWe"),Ne(function(){var e=document.createElement("div");return e.className="link-popover-root",document.body.appendChild(e),e})(Be=function(e){function t(e){var n;return u()(this,t),(n=h()(this,y()(t).call(this,e))).renderedOnce=void 0,n.toolbar=void 0,n.preventDefault=function(e){e.preventDefault(),e.stopPropagation()},n.handleRemoveLink=function(){var e=n.props,t=e.entityKey,r=e.blockKey;n.props.onRemoveLink(r,t)},n.handleEditLink=function(){n.props.onEditLink()},n.state={position:{}},n.renderedOnce=!1,n.toolbar=null,n}return m()(t,e),d()(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props,n=t.blockKey,r=t.entityKey;if(this.renderedOnce){var i=n!==e.blockKey||r!==e.entityKey;return i&&(this.renderedOnce=!1),i}return this.renderedOnce=!0,!0}},{key:"render",value:function(){var e=this,t=this.props.url;return t.length>30&&(t="".concat(t.slice(0,30),"...")),v.createElement("div",{role:"toolbar",tabIndex:0,className:"link-popover-container",ref:function(t){e.toolbar=t},onMouseDown:this.preventDefault},v.createElement("div",{className:"link-popover-content"},v.createElement("a",{href:this.props.url,title:this.props.url,target:"_blank",rel:"noopener noreferrer"},t),v.createElement("button",{onClick:this.handleEditLink},"修改链接"),v.createElement("button",{onClick:this.handleRemoveLink},"取消链接")))}}]),t}(v.Component))||Be),Fe=n("fk1ifl"),He=n.n(Fe),qe=n("UXZVaL"),je=n.n(qe),We=function(){var e={},t=!1;return{initialize:function(t){je()(e,t)},handleBeforeInput:function(n,r){var i=e.setEditorState;if(r.getSelection().isCollapsed()&&" "===n){var o=r=function(e,t){var n=k.Modifier.insertText(e.getCurrentContent(),e.getSelection(),t,e.getCurrentInlineStyle());return k.EditorState.forceSelection(k.EditorState.push(e,n,"insert-characters"),n.getSelectionAfter())}(r,n),a=x(r),l=a.getText();return"unstyled"!==a.getType()?"not-handled":(/^([-+*]) $/.test(l)&&(o=_(r,"unordered-list-item")),/^1\. $/.test(l)&&(o=_(r,"ordered-list-item")),o!==r?(i(o),t=!0,"handled"):"not-handled")}return"not-handled"},handleCommand:function(n){var r=e.setEditorState,i=(0,e.getEditorState)();return"backspace"===n&&t?(r(k.EditorState.undo(i)),"handled"):"not-handled"},onChange:function(e){return t=!1,e}}},ze={LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,CAP:20,SHIFT:16,CTRL:17,ALT:18,COMMAND:91,WIN:92,BACKSPACE:8,DELETE:46,SPACE:32,ENTER:13,ESC:27,PAGE_UP:33,PAGE_DOWN:34,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},Ge="toggle-block-type",Ve="toggle-inline-style",Xe=function(){var e={};return{initialize:function(t){je()(e,t)},keyBindingFn:function(e){if(e.metaKey&&k.KeyBindingUtil.isOptionKeyCommand(e)||e.ctrlKey&&e.altKey){if(e.shiftKey)return null;switch(e.keyCode){case ze[1]:return"".concat(Ge,"-header-one");case ze[2]:return"".concat(Ge,"-header-two");case ze[3]:return"".concat(Ge,"-header-three");case ze[4]:return"".concat(Ge,"-header-four")}}if(k.KeyBindingUtil.hasCommandModifier(e)&&e.shiftKey)switch(e.keyCode){case ze.J:return"".concat(Ge,"-code-block");case ze.B:return"".concat(Ge,"-blockquote");case ze.O:return"".concat(Ge,"-ordered-list-item");case ze.U:return"".concat(Ge,"-unordered-list-item")}if(k.KeyBindingUtil.hasCommandModifier(e))switch(e.keyCode){case ze.B:return"".concat(Ve,"-BOLD");case ze.I:return"".concat(Ve,"-ITALIC");case ze.U:return"".concat(Ve,"-UNDERLINE");case ze.D:return"".concat(Ve,"-STRIKETHROUGH");case ze.J:return"".concat(Ve,"-CODE");case ze.S:return"save"}return Object(k.getDefaultKeyBinding)(e)},handleCommand:function(t){var n=e.setEditorState,r=(0,e.getEditorState)(),i=R(r).inlineDisabled;if(t.startsWith("toggle-inline-style-")){if(i)return"not-handled";var o=t.replace(/^toggle-inline-style-/,"");return n(k.RichUtils.toggleInlineStyle(r,o)),"handled"}if(t.startsWith("toggle-block-type-"))return n(function(e,t){var n=e.getSelection(),r=k.RichUtils.toggleBlockType(e,t).getCurrentContent();if("code-block"===t){var i=n.getStartKey(),o=n.getEndKey(),a=r.getBlockForKey(o),l=new k.SelectionState({anchorKey:i,anchorOffset:0,focusKey:o,focusOffset:a.getLength()});r=Y(r,l)}return k.EditorState.forceSelection(k.EditorState.push(e,r,"change-block-type"),n)}(r,t.replace(/^toggle-block-type-/,""))),"handled";var a=k.RichUtils.handleKeyCommand(r,t);return a?(n(a),"handled"):"not-handled"}}},Ze=(n("+rOxwC"),function(e){function t(){return u()(this,t),h()(this,y()(t).apply(this,arguments))}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props.className,t=T()(e,"editor-divider");return v.createElement("div",{className:t},v.createElement("hr",null))}}]),t}(v.PureComponent)),Je=function(e){var t=e.decorator,n={},r=de()(t)?t(Ze):Ze;return{initialize:function(e){je()(n,e)},keyBindingFn:function(e){if(k.KeyBindingUtil.hasCommandModifier(e)&&e.shiftKey&&e.keyCode===ze.D)return"insert-divider"},handleCommand:function(e){var t=n.setEditorState,r=(0,n.getEditorState)();if(R(r).entityDisabled)return"not-handled";if("insert-divider"===e){var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getCurrentContent().createEntity(D,"IMMUTABLE",t).getLastCreatedEntityKey(),r=k.AtomicBlockUtils.insertAtomicBlock(e,n," ");return k.EditorState.forceSelection(r,r.getCurrentContent().getSelectionAfter())}(r);return i&&t(i),"handled"}return"not-handled"},blockRendererFn:function(e,t){var n=t.getEditorState;if(e.getType()===w){var i=n().getCurrentContent(),o=e.getEntityAt(0);return o&&i.getEntity(o).getType()===D?{component:r,editable:!1}:null}return null}}},Qe=(n("ac8qPa"),function(e){function t(){var e,n;u()(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(n=h()(this,(e=y()(t)).call.apply(e,[this].concat(i)))).getEntity=function(){var e=n.props,t=e.contentState,r=e.entityKey;return t.getEntity(r)},n.getData=function(){return n.getEntity().getData()},n}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props.children,t=this.getData();return v.createElement("a",{className:"editor-link",href:t.url,target:"_blank",rel:"noreferrer noopener"},e)}}]),t}(v.PureComponent)),Ye=function(e,t,n){e.findEntityRanges(function(e){var t=e.getEntity();return null!==t&&n.getEntity(t).getType()===O},t)},_e=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{decorators:[{strategy:Ye,component:function(e){return v.createElement(Qe,e)}}],keyBindingFn:function(e){if(k.KeyBindingUtil.hasCommandModifier(e)&&!e.shiftKey&&e.keyCode===ze.K)return"insert-link"}}},$e=Ne(function(){var e=document.createElement("div");return e.className="image-caption-root",document.body.appendChild(e),e})(Le=function(e){function t(){return u()(this,t),h()(this,y()(t).apply(this,arguments))}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.position,r=e.inputRef,i=e.onBlur,o=e.onChange,a=e.onKeyDown;return v.createElement("div",{className:"editor-image-caption-input",style:n},v.createElement("textarea",{ref:r,value:t,onChange:o,onBlur:i,onKeyDown:a}))}}]),t}(v.PureComponent))||Le,et=21,tt=function(e){var t,n;return n=t=function(t){function n(){return u()(this,n),h()(this,y()(n).apply(this,arguments))}return m()(n,t),d()(n,[{key:"render",value:function(){var t=this.props.blockProps;return v.createElement(e,o()({},this.props,t))}}]),n}(v.PureComponent),t.displayName="withBlockProps(".concat(Me(e),")"),n}((Ie=we=function(e){function t(e){var n;return u()(this,t),(n=h()(this,y()(t).call(this,e))).caption=void 0,n.captionInput=void 0,n.getPosition=function(){var e=n.caption.getBoundingClientRect(),t=e.width,r=e.height,i=e.top,o=e.left;return{width:t,height:r,top:i+window.pageYOffset,left:o+window.pageXOffset}},n.adjustCaptionHeight=function(){var e=n.captionInput,t=n.caption,r=Math.max(e.scrollHeight,et);t.style.height="".concat(r,"px"),e.style.height="".concat(r,"px")},n.startEditCaption=function(){n.props.setReadOnly(!0);var e=n.props.data.caption,t=void 0===e?"":e;n.setState({isCaptionEditing:!0,captionPosition:n.getPosition(),captionInputValue:t},function(){requestAnimationFrame(function(){var e=n.captionInput;e.focus(),e.select(),requestAnimationFrame(function(){n.setState({captionPosition:n.getPosition()})})})})},n.editCaption=function(){var e=n.captionInput.value;n.adjustCaptionHeight(),n.setState({captionInputValue:e})},n.endEditCaption=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.save,r=void 0===t||t,i=e.focus,o=void 0!==i&&i;if(n.props.setReadOnly(!1),n.caption.style.height=null,r){var a=n.props,l=a.getEditorState,c=a.setEditorState,u=a.blockKey,s=a.entityKey,d=n.state.captionInputValue,f=l(),h=J(f,s,{caption:d});if(o){var p=h.getCurrentContent(),y=p.getKeyAfter(u);if(y){var g=p.getBlockForKey(y).getLength();h=k.EditorState.forceSelection(h,new k.SelectionState({anchorKey:y,anchorOffset:g,focusKey:y,focusOffset:g,hasFocus:!0}))}}c(h)}n.setState({isCaptionEditing:!1})},n.handleCaptionClick=function(e){e.preventDefault(),n.startEditCaption()},n.handleCaptionInputBlur=function(){n.endEditCaption()},n.handleCaptionInputKeyDown=function(e){var t=e.keyCode===ze.ENTER,r=e.keyCode===ze.ESC;(t||r)&&(e.preventDefault(),n.endEditCaption({save:t,focus:t}))},n.state={isCaptionEditing:!1,captionInputValue:n.props.data.caption||"",captionPosition:{}},n.caption=null,n.captionInput=null,n}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.data,i=r.src,o=r.caption,a=void 0===o?"":o,l=t.isFocused,c=this.state,u=c.isCaptionEditing,s=c.captionInputValue,d=c.captionPosition,f=T()(n,"editor-image-entity"),h=T()("editor-image-caption",{"editor-image-caption-editing":u,"editor-image-caption-is-placeholder":!a});return v.createElement("div",{role:"figure",className:"editor-image-package"},v.createElement("img",{onClick:this.props.onClick,className:f,src:i,alt:a}),(l||u||a)&&v.createElement("figcaption",{className:h,ref:function(t){e.caption=t},onClick:this.handleCaptionClick},a||"添加图片说明"),u&&v.createElement($e,{inputRef:function(t){e.captionInput=t},position:d,value:s,onChange:this.editCaption,onBlur:this.handleCaptionInputBlur,onKeyDown:this.handleCaptionInputKeyDown}))}}]),t}(v.PureComponent),Re=xe=function(e){function t(){return u()(this,t),h()(this,y()(t).apply(this,arguments))}return m()(t,e),d()(t,[{key:"render",value:function(){var e=this;return v.createElement(le.Consumer,null,function(t){return v.createElement(Ie,o()({},e.props,t))})}}]),t}(v.PureComponent),xe.displayName="withEditorState(".concat(Me(Ie),")"),we=Re||we))||we;n("/vcn99");var nt=function(){var e,t,n,r=He()({theme:{focused:"focus-plugin-focused",unfocused:"focus-plugin-unfocused"}}),i=Object(E.composeDecorators)(r.decorator),o=Je({decorator:i}),a=_e(),l=(e=i,t={},n=de()(e)?e(tt):tt,{initialize:function(e){je()(t,e)},keyBindingFn:function(e){if(k.KeyBindingUtil.hasCommandModifier(e)&&e.shiftKey&&e.keyCode===ze.I)return"insert-image"},blockRendererFn:function(e,t){var r=t.getEditorState,i=t.setEditorState;if(e.getType()===w){var o=r().getCurrentContent(),a=e.getEntityAt(0);if(!a)return null;var l=o.getEntity(a);if(l.getType()===B){var c=l.getData();return{component:n,editable:!1,props:{data:c,blockKey:e.getKey(),entityKey:a,getEditorState:r,setEditorState:i}}}return null}return null}}),c=We(),u=Xe(),s={handleReturn:function(e,t,n){var r=n.setEditorState,i=t.getSelection(),o=x(t);return I(o,i)&&k.KeyBindingUtil.hasCommandModifier(e)?(r(Q(t)),"handled"):"not-handled"}},d={handleReturn:function(e,t,n){var r=n.setEditorState;return e.shiftKey?(r(k.RichUtils.insertSoftNewline(t)),"handled"):"not-handled"}},f={handleReturn:function(e,t,n){var r=n.setEditorState,i="not-handled",o=x(t),a=o.getType();return e.altKey||e.metaKey||e.ctrlKey||(a===w&&(r(Q(t)),i="handled"),0===o.getLength()&&["blockquote","unordered-list-item","ordered-list-item"].includes(a)&&(r(_(t,"unstyled")),i="handled")),i}},h={blockRenderMap:Object(z.Map)({"header-four":{element:"h4",aliasedElements:["h5","h6"]},"header-five":{},"header-six":{}}),handleReturn:function(e,t,n){var r=n.setEditorState,i=t.getSelection(),o=t.getCurrentContent().getBlockForKey(i.getStartKey());if(I(o,i)&&o.getType().startsWith("header-")){var a=Q(t);if(a)return r(a),"handled"}return"not-handled"}},p={blockRenderMap:Object(z.Map)({"code-block":{element:"code",wrapper:v.createElement("pre",{className:"public-DraftStyleDefault-pre"})}}),blockStyleFn:function(e){return"code-block"===e.getType()?"editor-code-block":null},handlePastedText:function(e,t,n,r){var i=r.setEditorState,o=n.getCurrentContent(),a=n.getSelection();if("code-block"===k.RichUtils.getCurrentBlockType(n)){var l=k.Modifier.replaceText(o,a,e);return i(k.EditorState.push(n,l,"insert-characters")),"handled"}return"not-handled"},handleReturn:function(e,t,n){var r=n.setEditorState;return"code-block"===k.RichUtils.getCurrentBlockType(t)?(r(k.RichUtils.insertSoftNewline(t)),"handled"):"not-handled"}},y=function(){var e={};return{initialize:function(t){je()(e,t)},keyBindingFn:function(e){if(k.KeyBindingUtil.hasCommandModifier(e)&&e.shiftKey&&e.keyCode===ze.L)return"clear-format"},handleCommand:function(t){var n=e.setEditorState,r=(0,e.getEditorState)();if("clear-format"===t){var i=$(r);return i&&n(i),"handled"}return"not-handled"}}}();return[r,o,a,l].concat([c,s,d,f,h,p,y],[u])},rt={CODE:{backgroundColor:"#e6e6e6",fontFamily:'"Inconsolata", "Menlo", "Consolas", monospace',padding:2,wordWrap:"break-word"}},it=function(e){switch(e.getType()){case"unstyled":return"editor-unstyled";case"blockquote":return"editor-blockquote";default:return null}},ot=function(e){function t(e){var n;u()(this,t),(n=h()(this,y()(t).call(this,e))).emitter=void 0,n.editor=void 0,n.plugins=void 0,n.focus=function(){n.editor.current.focus()},n.setReadOnly=function(e){n.setState({readOnly:e})},n.onEditorChange=function(e){var t=M(e);n.setState({editorState:e,currentLinkEntityKey:t?t.entityKey:null})},n.handleChange=function(e,t){var r=M(e);n.setState({editorState:e,currentLinkEntityKey:r?r.entityKey:null},t)},n.onTab=function(e){var t=n.state.editorState,r=k.RichUtils.onTab(e,t,4);return r!==n.state.editorState&&n.handleChange(r),null},n.handleReturn=function(e){n.state.editorState;return"not-handled"},n.handleCommand=function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=l()(n.plugins);!(t=(o=a.next()).done);t=!0){var c=o.value;if(c.handleCommand&&b()(c.handleCommand(e)))return!0}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}return!1},n.handleKeyCommand=function(e){var t=n.state.editorState,r=R(t).linkDisabled;return n.handleCommand(e)?"handled":"insert-link"===e?r?"not-handled":(n.openLinkModal(),"handled"):"insert-image"===e?(n.addImage(),"handled"):"save"===e?"handled":"not-handled"},n.openLinkModal=function(){n.setState({linkModalVisible:!0})},n.closeLinkModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.setState({linkModalVisible:!1},function(){t&&n.focus()})},n.addImage=function(){var e=n.state.editorState,t=Z(e,{src:"https://ss1.baidu.com/6ONXsjip0QIZ8tyhnq/it/u=2810627290,1080409091&fm=58",caption:"bilibili"});n.handleChange(t)},n.addOrEditLink=function(e,t){var r,i=t.title,o=t.url;e.preventDefault();var a=n.state,l=a.editorState,c=a.currentLinkEntityKey;if(null===c)r=G(l,{title:i,url:o});else{var u=l.getCurrentContent(),s=l.getSelection(),d=u.getBlockForKey(s.getFocusKey()).getKey();r=V(l,{title:i,url:o,blockKey:d,entityKey:c})}n.handleChange(r,function(){n.closeLinkModal(e,!0)})},n.removeLink=function(e,t){var r=n.state.editorState,i=X(r,e,t);n.handleChange(i)},n.showBlockTypeAndInlineStyle=function(){var e=n.state.editorState,t=e.getSelection(),r=e.getCurrentContent().getBlockForKey(t.getStartKey());console.log("contentBlock:",r),console.log("selection:",t),console.log("inlineStyle:",e.getCurrentInlineStyle().toJS())},n.logState=function(){var e=n.state.editorState.getCurrentContent();console.log("contentState:",e),console.log("rawContentState:",Object(k.convertToRaw)(e)),console.log("html:",function(e){if(!e.hasText())return"";var t="".concat(L,"-").concat(Object(k.genKey)(),"-").concat(+new Date);return Object(ee.convertToHTML)({styleToHTML:function(e){switch(e){case"BOLD":return v.createElement("b",null);case"ITALIC":return v.createElement("i",null);case"UNDERLINE":return v.createElement("u",null);case"CODE":return v.createElement("code",null);case"STRIKETHROUGH":return v.createElement("del",null);default:return{start:"",end:""}}},blockToHTML:function(e){switch(e.type){case"header-five":case"header-six":return{start:"<h4>",end:"</h4>"};case"unstyled":return{start:"<p>",end:"</p>",empty:"<p><br></p>"};case"code-block":return{element:v.createElement("code",null),nest:v.createElement("pre",null)};case"blockquote":return{element:v.createElement("p",null),nest:v.createElement("blockquote",null)};case w:return{start:"",end:""};default:return}},entityToHTML:function(e,n){var r=e.type,i=e.data;switch(r){case O:return v.createElement("a",{href:i.url},n);case D:return v.createElement("hr",null);case B:var o=i.src,a=i.caption;return v.createElement("div",{className:"image-package"},v.createElement("img",{src:o,alt:a||""}),v.createElement("br",null),v.createElement("div",{className:"image-caption"},a));case L:return t;default:return n}}})(e).replace(new RegExp("<br/>".concat(t),"g"),"").replace(/<\/code><code( lang="[^"]*")?>/g,"<br>").replace(/\n/g,"<br>")}(e))};var r=function(e){var t=e.replace(ie,""),n=ne(t);return Object(ee.convertFromHTML)({htmlToStyle:function(e,t,n){return"code"===e&&t.parentElement&&"PRE"===t.parentElement.tagName?n.remove("CODE"):n},htmlToBlock:function(e,t,n,r){switch(e){case"h5":case"h6":return{type:"header-four"};case"p":return{type:"unstyled"};case"blockquote":return{type:"blockquote",data:{}};case"div":return oe(t)?{type:w,data:{}}:null;case"hr":if(r!==w)return{type:w,data:{}};case"pre":if("code-block"===r)return{type:"code-block",data:{}};default:return}},htmlToEntity:function(e,t,n){switch(e){case"a":return n(O,"MUTABLE",{url:t.href});case"hr":return n(D,"IMMUTABLE",{});case"div":if(oe(t)){var r=t.querySelector("img").src,i=t.querySelector(".image-caption"),o=i?i.textContent||i.innerText:"";return n(B,"IMMUTABLE",{src:r,caption:o})}if(ae(t))return n(L,"IMMUTABLE",{fuck:1});default:return}}})(n)}("<h2>测试标题</h2><ul><li>111</li><li>222</li></ul><p>test</p>");return n.state={editorState:k.EditorState.createWithContent(r),currentLinkEntityKey:null,linkModalVisible:!1,readOnly:!1},n.emitter=new ce,n.editor=v.createRef(),n.plugins=nt(),n}return m()(t,e),d()(t,[{key:"componentDidMount",value:function(){this.emitter.on("handleEditorWithCommand",this.handleKeyCommand)}},{key:"componentWillUnmount",value:function(){this.emitter.off("handleEditorWithCommand",this.handleKeyCommand)}},{key:"render",value:function(){var e=this.state,t=e.editorState,n=e.readOnly,i=e.linkModalVisible,a=e.currentLinkEntityKey,l=M(t),c=function(e,t){var n=e.getCurrentContent(),r=e.getSelection(),i=x(e),o=i.getKey();if(t){var a=n.getEntity(t).getData().url;return{defaultTitle:function(e,t,n){var r=e.getCurrentContent().getBlockForKey(t),i=0,o=0,a="";return r.findEntityRanges(function(e){return e.getEntity()===n},function(e,t){i=e,o=t,a=r.getText().slice(i,o)}),{start:i,end:o,text:a}}(e,o,t).text,defaultUrl:a}}return r.getAnchorKey()!==r.getFocusKey()?null:{defaultTitle:i.getText().slice(r.getStartOffset(),r.getEndOffset())}}(t,a),u=t.getCurrentContent(),s=T()({"editor-container":!0,"editor-container-hide-placeholder":!u.hasText()&&"unstyled"!==u.getFirstBlock().getType()});return v.createElement(le.Provider,{value:{editorState:t,readOnly:n,setReadOnly:this.setReadOnly}},v.createElement(v.Fragment,null,v.createElement("div",{className:"editor-root"},v.createElement(ve,{editorState:t,onCommand:this.handleKeyCommand}),v.createElement("div",{role:"textbox",tabIndex:0,className:s,onClick:this.focus},v.createElement(C.a,{editorState:t,readOnly:n,blockStyleFn:it,customStyleMap:rt,placeholder:"请输入正文",ref:this.editor,spellCheck:!1,handleReturn:this.handleReturn,handleKeyCommand:this.handleKeyCommand,onChange:this.onEditorChange,onTab:this.onTab,plugins:this.plugins}))),l&&v.createElement(Pe,{editorState:t,url:l.url,blockKey:l.blockKey,entityKey:l.entityKey,onEditLink:this.openLinkModal,onRemoveLink:this.removeLink}),v.createElement(Oe,o()({},c,{visible:i,onOk:this.addOrEditLink,onCancel:this.closeLinkModal})),v.createElement("p",{style:{margin:12,marginLeft:0}},v.createElement(r.a,{type:"primary",onClick:this.showBlockTypeAndInlineStyle},"check status"),v.createElement(r.a,{style:{marginLeft:8},type:"danger",onClick:this.logState},"log state"))))}}]),t}(v.PureComponent);t.a=ot},ac8qPa:function(e,t,n){},jh8Gba:function(e,t,n){},ps4ltS:function(e,t,n){},v9FTWe:function(e,t,n){}},[["2YZa3H",1,2]]]);